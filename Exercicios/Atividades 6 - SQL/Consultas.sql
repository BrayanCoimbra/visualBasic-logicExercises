--Comandos criados para exercício interno durante treinamento na Lydians em 2024.
----------------------------------------

DROP TABLE IF EXISTS LIVROS;
CREATE TABLE LIVROS (
  ID_LIVRO BIGINT NOT NULL ,
  NOME VARCHAR(45) DEFAULT NULL,
  EDICAO NUMERIC(11) DEFAULT NULL,
  DT_EXPEDICAO DATE DEFAULT NULL,
  QTD_ESTOQUE NUMERIC(11) DEFAULT NULL,
  PRECO FLOAT DEFAULT NULL,
  PRIMARY KEY (ID_LIVRO),
);

INSERT INTO LIVROS (ID_LIVRO, NOME, EDICAO, DT_EXPEDICAO, QTD_ESTOQUE, PRECO) VALUES (3,'O NOME DO VENTO',2,'2009-06-23',100,41.27),(4,'O TEMOR DO SÁBIO',1,'2011-11-20',77,45.63),(5,'ARMAS DE TORTUGA',1,'1999-04-28',10,34),(6,'A MÚSICA DO SILÊNCIO',1,'2013-06-15',120,18.65),(7,'WAY OF KINGS',4,'2001-04-20',300,29.53),(8,'WORDS OF RADIANCE',3,'2014-04-05',200,32.15),(9,'OATHBRINGER',1,'2016-04-17',150,35.83),(10,'A QUEDA',2,'2018-04-13',50,22.9),(11,'O PISTOLEIRO',2,'2011-04-14',180,40.34),(12,'MAGO E VIDRO',2,'2015-04-12',130,74.43),(13,'A STARTUP ENXUTA',4,'2007-04-10',140,28.5),(14,'HARRY POTTER E O CÁLICE DE FOGO',5,'2004-04-07',60,36.38),(15,'HARRY POTTER E O ENIGMA DO PRINCIPE',3,'2006-04-30',30,34.99),(16,'PAI RICO, PAI POBRE',7,'1995-04-25',1000,39.99),(17,'AS PORTAS DE PEDRA',NULL,NULL,NULL,100);

--------------------------------------------------

DROP TABLE IF EXISTS PESSOAS;
CREATE TABLE PESSOAS (
  ID_PESSOA BIGINT NOT NULL,
  NOME VARCHAR(20) DEFAULT NULL,
  SOBRENOME VARCHAR(45) DEFAULT NULL,
  DATA_NASCIMENTO DATE DEFAULT NULL,
  RESIDENCIA VARCHAR(45) DEFAULT NULL,
  FUNCIONARIO TINYINT DEFAULT NULL,
  CPF VARCHAR(11) DEFAULT NULL,
  TELEFONE NUMERIC(11) DEFAULT NULL,
  PRIMARY KEY (ID_PESSOA),
);

INSERT INTO PESSOAS VALUES (2,'LUCAS','PEREIRA','1997-04-12','RUA JOÃO BAPTISTA SCALCO',1,'83432488050',948124864),(3,'JULIANA','SILVA','1990-03-01','RUA BROMÉLIAS',1,'30859454070',949814618),(4,'PAULO','ALMEIDA','1981-07-10','RUA CORONEL ANÍBAL DE ANDRADE',1,'77885049043',977740098),(5,'SANDRA','FARIA','1997-11-11','RUA ALIPIO DUTRA',1,'98584621075',988828984),(6,'MIGUEL','RODRIGUES','1997-08-01','RUA CARVALHO E MELO',1,'92683139012',997324872),(7,'RAFAEL','LIMA','1997-07-26','PRAÇA FREI PAULO',1,'39300155016',998523198),(8,'VINICIUS','SOUZA','1997-06-17','RUA DORIVAL FERREIRA',1,'79715900240',956237008),(9,'MARIA','CAVALCANTI','1997-03-13','RUA VISCONDE DE SÃO LOURENÇO',1,'56578773061',947523418),(10,'JOSÉ','COSTA','1997-05-14','PRAÇA EDMUNDO DA LUZ PINTO',1,'79002997000',957624235),(11,'CARLOS','OLIVEIRA','1997-04-22','AVENIDA SARGENTO CARLOS ARGEMIRO CAMARGO',1,'65336136000',952638973),(12,'VALERIA','BARBOSA','1997-12-02','RUA JULIETA',1,'43265967085',923856235),(13,'ADRIANA','BARROS','1999-04-01','RUA FLORAI',0,'17858811088',956324199),(14,'PEDRO','BATISTA','1992-08-18','RUA GUARAJUBA',0,'49055201006',NULL),(15,'ANA','RODRIGUES','1989-02-11','TRAVESSA SÃO JOAQUIM',0,'56896350492',997856353),(16,'VICENTE','BORGES','1997-04-17','ESTRADA CRUZ DAS ALMAS',0,'84655966033',998065263),(17,'ANTONIO','DIAS','1977-06-30','RUA SOLDADO JOÃO RECHOCOSKI',0,'68434195003',989645007),(18,'JULIANA','CARDOSO','1965-10-31','PRAÇA GENERAL SANTANDES',0,'66101712036',996235986),(19,'JOÃO','FREITAS','1982-12-12','RUA SÃO FILEIAS',0,'67052297051',NULL),(20,'FRANCISCO','MARTINS','1986-11-09','RUA MESTRE VITALINO',0,'1906371024',990970777),(21,'CAMILA','CAMPOS','1995-07-04','RUA HERVAL ROSSANO',0,'83230880048',NULL),(22,'BRUNA','MACHADO','1987-09-07','RUA MESTRE VITALINO',0,'64610073005',909872347),(23,'JOSÉ','CASTA','1983-02-10','RUA HERVAL ROSSANO',0,'70859369080',958726393),(24,'LUIZ','GONÇALVES','1980-02-01','RUA MAGISTRADO',0,'14882069024',987792534),(25,'MATEUS','CASTRO','1978-01-09','RUA ANA BARBOSA',0,'11102184004',951478624),(26,'GUILHERME','NUNES','1994-06-27','RUA NARCELIO DE QUEIROS',0,'50613587081',998236237),(27,'AMANDA','VIEIRA','1993-09-15','RUA DOUTOR PADILHA',0,'1130248003',959263963),(28,'JESSICA','CARVALHO','1988-11-16','RUA GUIDOVAL',0,'67404832055',983277340);

--------------------------------------------------

DROP TABLE IF EXISTS PEDIDOS;
CREATE TABLE PEDIDOS (
  ID_PEDIDOS BIGINT NOT NULL,
  NUM_PEDIDO NUMERIC(11) DEFAULT NULL,
  ID_LIVRO BIGINT NOT NULL,
  ID_PESSOA BIGINT NOT NULL,
  QTD_PEDIDA NUMERIC(11) DEFAULT NULL,
  PRIMARY KEY (ID_PEDIDOS),
);


INSERT INTO PEDIDOS VALUES (3,15,16,20,5),(4,1,6,3,1),(5,2,16,3,12),(6,3,13,3,11),(7,4,10,3,10),(8,5,15,5,2),(9,6,5,9,5),(10,7,11,11,3),(11,8,13,14,2),(12,9,7,16,7),(13,10,8,16,3),(14,11,9,16,2),(15,12,9,17,1),(16,13,3,18,1),(17,14,4,18,1),(18,16,16,20,5);


Atividade proposta:
01- Retornar da tabela pessoas somente o Miguel
SELECT NOME FROM PESSOAS WHERE NOME = 'MIGUEL'

02- Retornar todos os campos da tabela LIVROS o livro cujo valor é de R$40,34
SELECT * FROM LIVROS WHERE round(preco, 2) = 40.34;

03- Retornar todos os LIVROS cuja data de expedição (dt_expedicao) é do ano de 2011
SELECT * FROM LIVROS WHERE DATEPART (YEAR, DT_EXPEDICAO) = '2011';

04- Retornar todos os LIVROS cuja data de expedição (dt_expedicao) é do mês de novembro
SELECT * FROM LIVROS WHERE DATEPART (MONTH, DT_EXPEDICAO) = '11';

05- Retornar todos os LIVROS cuja data de expedição (dt_expedicao) está entre o intervalo do dia 5 e 20 de qualquer mês e ano.
SELECT * FROM LIVROS WHERE DAY(DT_EXPEDICAO) BETWEEN 5 AND 20;

06- Trazer da tabela LIVROS todos os campos e LIVROS cuja edição não é nula.
SELECT * FROM LIVROS WHERE EDICAO IS NOT NULL

07- Trazer da tabela LIVROS todos os LIVROS com seus respectivos campos cuja edição é igual ou maior do que 2 e a quantidade no estoque (qtd_estoque) é menor do que 100
SELECT * FROM LIVROS WHERE EDICAO >= 2 AND QTD_ESTOQUE < 100

08- Trazer todos os LIVROS com seus respectivos campos cuja edição é maior do que 5 e a quantidade no estoque (qtd_estoque) é maior do que 100
SELECT * FROM LIVROS WHERE EDICAO > 5 AND QTD_ESTOQUE > 100

09- Retornar todos os pedidos cuja quantidade pedida (qtd_pedida) NÃO é menor do que 5
SELECT * FROM PEDIDOS WHERE QTD_PEDIDA >=5 

10- Retornar todos os LIVROS que possui Harry no nome
SELECT * FROM LIVROS WHERE NOME LIKE '%HARRY%'

11- Retornar todos os LIVROS que possui silêncio no nome (cuidado com o caractere acentuado)
SELECT * FROM LIVROS WHERE NOME LIKE '%sil%ncio%'

12- Retornar todos os LIVROS com ao menos um caractere
SELECT * FROM LIVROS WHERE LEN(NOME) > 0;

13- Retornar todos os LIVROS com exatamente 12 caracteres
SELECT * FROM LIVROS WHERE LEN(NOME) = 12;

14- RetornaR todos os LIVROS onde a qtd_estoque é exatamente igual a 100 ou 120 ou 200 ou 60
SELECT * FROM LIVROS WHERE QTD_ESTOQUE = 100 OR QTD_ESTOQUE = 120 OR QTD_ESTOQUE = 200 OR QTD_ESTOQUE = 60;

15 - Retornar todas as pessoas que nasceram (data_nascimento) entre 1950 e 2010
SELECT * FROM PESSOAS WHERE DATA_NASCIMENTO BETWEEN '1950-01-01' AND '2010-12-31';

16- Retornar todas as pessoas que nasceram entre 01 de janeiro de 1950 e 31 de dezembro de 2010
SELECT * FROM PESSOAS WHERE DATA_NASCIMENTO BETWEEN '1950-01-01' AND '2010-12-31'

17- Retornar da tabela pessoa todas o ano (somente o ano) de nascimento de cada uma delas alterando o nome da coluna data_nascimento para "Ano Nascimento"
SELECT DATEPART (YEAR, DATA_NASCIMENTO) AS "ANO NASCIMENTO" FROM PESSOAS;

18- Trazer de LIVROS o nome a qtd_estoque e o preço de cada livro com a seguinte fórmula: preço = (5 * preço) com 2 casas decimais. Altere o nome da coluna nome para "Nome", qtd_estoque para "Estoque" e preco para "Preço"
SELECT NOME AS 'NOME', QTD_ESTOQUE AS 'ESTOQUE', ROUND((PRECO * 5) ,2) AS 'PREÇO' FROM LIVROS

19- Busca o nome de todas as pessoas da tabela pessoa retornando se possui o contato. Caso não possua retornar 'Não' e se possuir retornar 'Sim' em uma coluna chamada 'Contato'
SELECT NOME, CASE WHEN TELEFONE IS NULL THEN 'NÃO' ELSE 'SIM' END AS 'CONTATO' FROM PESSOAS;